\documentclass[a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[catalan]{babel}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{lmodern}
\usepackage{microtype}

\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\id}{\mathrm{id}}

\DeclareMathOperator{\sgn}{sgn}

\newenvironment{solution}{
    \renewcommand\qedsymbol{\ensuremath{\lozenge}}
    \begin{proof}[Solució]
        }{
    \end{proof}
}

\title{Símbol de Jacobi}
\author{Claudi Lleyda Moltó}
\date{1462908}

\begin{document}
\maketitle

\paragraph{El Símbol de Jacobi} Sigui~\(m\) un enter positiu senar.
Podem escriure així~\(m=p_{1}\cdots p_{s}\) on els~\(p_{i}\) són primers senars,
no necessàriament diferents.
Es defineix el~\emph{símbol de Jacobi} com:
\[
    \Bigl(\frac{a}{m}\Bigr)
    =
    \prod_{i=1}^{s}
    \Bigl(\frac{a}{p_{i}}\Bigr).
\]

\begin{enumerate}
    \item[\textbf{a)}] Sigui~\(m\geq2\) un nombre enter.
        Donat~\(a\in\ZZ\) un nombre primer amb~\(m\),
        considerem l'aplicació~\(\mu_{a}:\ZZ/m\ZZ\longrightarrow\ZZ/m\ZZ\)
        definida com~\(\mu_{a}(n)=an\) per a tot~\(n\in\ZZ/m\ZZ\).
        \begin{enumerate}
            \item[\textbf{i)}] Demostreu que~\(\mu_{a}\) és un automorfisme.
        \end{enumerate}
\end{enumerate}

\begin{solution}
    Primer veiem que~\(\mu_{a}\) és un morfisme de grups.
    Per a tots~\(x,y\in\ZZ/m\ZZ\) tenim
    \[
        \mu_{a}(x+y) = a(x+y) = ax + ay = \mu_{a}(x) + \mu_{a}(y)
        \qquad
        \text{i}
        \qquad
        \mu_{a}(0) = a0 = 0.
    \]
    Per últim veiem que per a tot~\(n\in\ZZ/m\ZZ\) es satisfà
    \[
        \mu_{a}(-n) = a(-n) = -(an) = -\mu_{a}(n),
    \]
    i concloem que~\(\mu_{a}\) és un morfisme de grups.

    Veiem ara que~\(\mu_{a}\) és bijectiva.
    Per això en tenim prou amb veure que és exhaustiva,
    donat que~\(\ZZ/m\ZZ\) és un finit.

    Observem que podem veure que~\(\mu_{a}\) és exhaustiva veient que~\(a\) té
    invers a~\(\ZZ/m\ZZ\),
    ja que aleshores tindríem
    \[
        \mu_{a}(a^{-1}n) = aa^{-1}n = n
    \]
    per a tot~\(n\in\ZZ/m\ZZ\).

    Veiem doncs que~\(a\) és invertible a~\(\ZZ/m\ZZ\).
    Recordem que hem suposat que~\(a\) i~\(m\) són coprimers.
    Aleshores pel Lema de Bézout tenim que existeixen~\(b,c\in\ZZ\) tals que
    \[
        ab + mc = 1,
    \]
    i per tant
    \[
        ab \equiv 1 \pmod{m},
    \]
    i veiem~\(a\) és invertible a~\(\ZZ/m\ZZ\),
    pel que tenim que~\(\mu_{a}\) és exhaustiva,
    i per tant bijectiva,
    com ens calia demostrar.
\end{solution}

\begin{enumerate}
    \item[] \begin{enumerate}
        \item[\textbf{ii)}] Demostreu que~\(\mu_{ab} = \mu_{a}\circ\mu_{b}\) per
            a tot~\(a\) i~\(b\) coprimers amb~\(m\).
    \end{enumerate}
\end{enumerate}

\begin{solution}
    Tenim que per a tot~\(n\in\ZZ/m\ZZ\) es satisfà
    \[
        \mu_{ab}(n)
        = abn
        = a(bn)
        = \mu_{a}(bn)
        = \mu_{a}\bigl(\mu_{b}(n)\bigr)
        = \mu_{a}\circ\mu_{b}(n),
    \]
    i per tant~\(\mu_{ab} = \mu_{a}\circ\mu_{b}\).
\end{solution}

\begin{enumerate}
    \item[] \begin{enumerate}
        \item[\textbf{iii)}] Demostreu que si~\(m=nn'\),
            i considerem el subgrup~\(H_{n}=n'\ZZ/m\ZZ\),
            aleshores tenim~\(\ZZ/n\ZZ \cong H_{n}\)
            enviant~\(b\mapsto n'b\),
            que~\(\mu_{a}(H_{n})=H_{n}\)
            i que~\(\mu_{a}\rvert_{H_{n}}=\mu_{a}\)
            via la identificació de~\(H_{n}\)
            amb~\(\ZZ/n\ZZ\).
    \end{enumerate}
\end{enumerate}

\begin{solution}
    Tenim que
    \[
        n'\ZZ/m\ZZ
        \cong
        (n'\ZZ/m\ZZ)/(m\ZZ/m\ZZ)
        \cong
        \ZZ/n\ZZ.
        \qedhere
    \]
\end{solution}

\begin{enumerate}
    \item[] \begin{enumerate}
        \item[\textbf{iv)}] Demostreu que si~\(m=p^{r}\),
            amb~\(p\) un primer senar
            i~\(r>1\), aleshores
            \[
                (\ZZ/p^{r}\ZZ)/H_{p^{r-1}} = (\ZZ/p^{r}\ZZ)^{\times}
            \]
            és el conjunt dels elements invertibles.
            Denotem per~\(\mu_{a}^{\times}\)
            la restricció de~\(\mu_{a}\) a~\((\ZZ/p^{r}\ZZ)^{\times}\),
            i si~\(g\) és un generador de~\((\ZZ/p^{r}\ZZ)^{\times}\),
            identifiquem
            \[
                (\ZZ/p^{r}\ZZ)^{\times}
                =
                \{ g^{i} \mid i\in \{1,\dots,N\}\}
                \equiv
                \{1,\dots,N\}
            \]
            on~\(N = \lvert(\ZZ/p^{r}\ZZ)^{\times}\rvert\).
            Demostreu que, amb aquesta identificació,
            \[
                \mu_{g}^{\times} \leftrightarrow (1,2,\dots,N).
            \]
    \end{enumerate}
\end{enumerate}

\begin{solution}
    Observem que
    \[
        \mu_{g}^{\times}(k)
        = \mu_{g}^{\times}(g^{k})
        = gg^{k}
        = g^{k+1}
        = (k+1\%N)+1
    \]
    i per tant~\(\mu_{g}^{\times}\) és el cicle que descriu l'enunciat.
\end{solution}

\begin{enumerate}
    \item[\textbf{b)}] Denotem que~\([\frac{a}{m}]\) el signe~\(\sgn(\mu_{a})\)
        de la permutació donada per l'aplicació~\(\mu_{a}\) a~\(\ZZ/m\ZZ\).
        \begin{enumerate}
            \item[\textbf{i)}] Demostreu que si~\(a=a_{1}a_{2}\), aleshores
                \[
                    \Bigl[\frac{a}{m}\Bigr]
                    =
                    \Bigl[\frac{a_{1}}{m}\Bigr]
                    \Bigl[\frac{a_{2}}{m}\Bigr].
                \]
        \end{enumerate}
\end{enumerate}

\begin{solution}
    Observem que si~\(a\) és coprimer amb~\(m\),~\(a_{1}\) i~\(a_{2}\) també ho
    seran. Per tant podem aplicar l'apartat~\textbf{a)ii)} per veure que
    \[
        \mu_{a} = \mu_{a_{1}a_{2}} = \mu_{a_{1}}\circ\mu_{a_{2}},
    \]
    i aleshores tenim que
    \[
        \Bigl[\frac{a}{m}\Bigr]
        = \sgn(\mu_{a})
        = \sgn(\mu_{a_{1}}\circ\mu_{a_{2}})
        = \sgn(\mu_{a_{1}})\sgn(\mu_{a_{2}})
        = \Bigl[\frac{a_{1}}{m}\Bigr]\Bigl[\frac{a_{2}}{m}\Bigr].
        \qedhere
    \]
\end{solution}

\begin{enumerate}
    \item[]\begin{enumerate}
        \item[\textbf{ii)}] Demostreu que si~\(m=m_{1}m_{2}\),
            amb~\(\gcd(m_{1},m_{2})=1\), aleshores
            \[
                \Bigl[\frac{a}{m}\Bigr]
                =
                \Bigl[\frac{a}{m_{1}}\Bigr]
                \Bigl[\frac{a}{m_{2}}\Bigr].
            \]
    \end{enumerate}
\end{enumerate}

\begin{solution}
    Podem fer la demostració per~\(m_{1},m_{2}\) primers, i generalitzar-la al
    resultat que volem, així que suposem que~\(m_{1}\) i~\(m_{2}\) són primers
    diferents. Aleshores
    \[
        \ZZ/m\ZZ
        \cong
        \ZZ/m_{1}\ZZ\times\ZZ/m_{2}\ZZ
    \]
    Observem que el signe d'una permutació és igual a~\(-1\) elevat a la meitat
    del nombre d'elements que no són fixats per aquesta. Per tant el signe de la
    permutació~\(\mu_{a}\) a~\(\ZZ/m\ZZ\) serà igual a la meitat de la quantitat
    d'elements que són fixats per~\(\mu_{a}\) simultàniament a~\(\ZZ/m_{1}\ZZ\)
    i a~\(\ZZ/m_{2}\ZZ\).

    Aleshores, si definim~\(\mu'_{1}\) com el nombre d'elements no fixats
    per~\(\mu_{a}\) a~\(\ZZ/m_{1}\ZZ\) i~\(\mu'_{2}\) com el nombre d'elements
    no fixats per~\(\mu_{a}\) a~\(\ZZ/m_{2}\ZZ\) tenim que el nombre d'elements
    no fixats per~\(\mu_{a}\) a~\(\ZZ/m\ZZ\) és la meitat de
    \[
        (m_{2}-m'_{2})m'_{1} + (m_{1}-m'_{1})m'_{2} + m'_{1}m'_{2},
    \]
    d'on veiem que aquest nombre presenta la mateixa paritat que~\(m'_{1}\)
    i~\(m'_{2}\), i hem acabat.
\end{solution}

\begin{enumerate}
    \item[\textbf{c)}]
        \begin{enumerate}
            \item[\textbf{i)}]
                Demostreu que per a tot~\(m\) senar i~\(a\) primer
                amb~\(m\) tenim que
                \[
                    \Bigl[\frac{a}{m}\Bigr]
                    =
                    \Bigl(\frac{a}{m}\Bigr).
                \]
        \end{enumerate}
\end{enumerate}

\begin{solution}
    Si~\(m=p_{1}\cdots p_{s}\) on els~\(p_{i}\) són primers senars, no
    necessàriament diferents, per l'apartat anterior tenim que
    \[
        \Bigl[\frac{a}{m}\Bigr]
        =
        \prod_{i=1}^{s}\Bigl[\frac{a}{p}\Bigr],
    \]
    i per tant només ens cal demostrar-ho pel cas~\(m=p\) primer.
    Si~\(N\) és l'ordre de~\(m\) a~\((\ZZ/p\ZZ)^{\times}\) tenim que la
    permutació~\(\mu_{a}\) descompon en~\((p-1)/N\) òrbites de longitud~\(N\), i
    per tant
    \[
        \sgn(\mu_{a}) = \bigl((-1)^{N-1}\bigr)^{(p-1)/N}.
    \]
    Observem que si~\(N\) és senar tindrem~\(\sgn(\mu_{a})=1\), i tindrem que
    existeix un~\(q\) tal que~\(q^{2}=a\). En efecte,~\(q=a^{(N+1)/2}\) ho
    satisfà.

    Si~\(N\) és parell, tindrem que~\(N=2M\) i~\(a^{N}\equiv1\pmod{p}\).
    Ara bé, pel criteri d'Euler tenim que~\(a\) és quadrat si i només
    si~\(a^{(p-1)/2}\equiv1\pmod{p}\), i per tant
    \[
        a^{(p-1)/2}
        \equiv
        (a^{N/2})^{(p-1)/N}
        \equiv
        (a^{M})^{(p-1)/N}
        \equiv
        (-1)^{(p-1)/N},
    \]
    pel que
    \[
        \biggl[\frac{a}{p}\biggr]
        =
        \biggl(\frac{a}{p}\biggr),
    \]
    i hem demostrat el que volíem.
\end{solution}

\begin{enumerate}
    \item[] \begin{enumerate}
        \item[\textbf{ii)}] Deduïu que si~\(m=m_{1}m_{2}\) aleshores
            \[
                \Bigl[\frac{a}{m}\Bigr]
                =
                \Bigl[\frac{a}{m_{1}}\Bigr]
                \Bigl[\frac{a}{m_{2}}\Bigr]
            \]
    \end{enumerate}
\end{enumerate}

\begin{solution}
    Es dedueix directament amb les propietats del símbol de Jacobi.
\end{solution}

\begin{enumerate}
    \item[\textbf{d)}] Siguin~\(m\) i~\(n\) dos enters senars positius i primers
        entre si. Si escollim com a representant de cada element de~\(\ZZ/m\ZZ\)
        un enter~\(0\leq a<m\), i també representants~\(0\leq b<n\) amb els
        elements de~\(\ZZ/n\ZZ\), demostreu que tenim tres bijeccions
        naturals~\(K,M,N:\ZZ/m\ZZ\times\ZZ/n\ZZ\rightarrow\ZZ/(mn)\ZZ\) donades
        per~\(L\) la bijecció que ens determina el teorema
        xinès,~\(N(a,b)=an+b\) i~\(M(a,b)=bm+a\).
\end{enumerate}

\begin{solution}
    Observem primer que si demostrem que~\(N\) és una bijecció podem obtenir el
    mateix resultat per~\(M\).

    Veiem que~\(N\) és bijectiva. Suposem que
    existeixen~\((a,b),(a',b')\in\ZZ/m\ZZ\times\ZZ/n\ZZ\) tals
    que~\(N(a,b)=N(a',b')\). Això vol dir que~\(bm+a\equiv b'm+a'\pmod{mn}\), i
    per tant~\((b-b')m\equiv a'-a\pmod{mn}\).

    Si fos~\(a\equiv a'\pmod{m}\), aleshores tindríem~\(b\equiv b'\pmod{mn}\), i
    per tant seria~\((a,b)\equiv(a',b')\), i simètricament si~\(b\equiv
    b'\pmod{n}\).

    Si fos~\((a-a')m\equiv b-b'\pmod{mn}\),
    aleshores~\((a-a')nm\equiv(b'-b)m\pmod{mn}\), i
    tindríem~\(0\equiv(b'-b)m\pmod{mn}\), pel que seria~\(b'\equiv b\)
    i~\(a'\equiv a'\), pel que~\(N\) és injectiva.

    Veiem ara que~\(N\) és exhaustiva. Si prenem un element~\(x\in\ZZ/mn\ZZ\)
    podem prendre~\(b=x\pmod{n}\) i~\(a=(x-b)n^{-1}\). Per tant~\(N\) és
    exhaustiva i tenim que ambdues~\(N\) i~\(M\) són bijectives.

    Per últim, tenim que~\(L\) és bijectiva, perquè de fet el teorema ens diu
    que és un isomorfisme.
\end{solution}

\begin{enumerate}
    \item[\textbf{e)}] Demostreu que per a tot~\(b\in\ZZ/m\ZZ\), el signe de la
        permutació~\(\sigma_{b}:\ZZ/m\ZZ\rightarrow\ZZ/m\ZZ\) que
        envia~\(\sigma_{b}(a)=a+b\) és sempre 1.
        Comproveu que la composició de~\(L^{-1}N\) és igual a
        l'aplicació~\((\sigma_{b}\circ\mu_{n})\times
        i:\ZZ/m\ZZ\times\ZZ/n\ZZ\rightarrow\ZZ/m\ZZ\times\ZZ/n\ZZ\)
        donada~\(((\sigma_{b}\circ\mu_{n})\times i)(a,b)=(na+b,b)\).
        Ídem amb~\(L^{-1}M\) i~\(i\times(\sigma_{a}\circ\mu_{m})\).
\end{enumerate}

\begin{solution}
    Si~\(b=0\) tenim que~\(\sigma_{b}=\id\), i per tant té signe~\(1\).

    Si~\(b\neq0\) tenim que existeixen~\(a\) i~\(a'\) tals
    que~\(\sigma_{b}(a)=a'\) i~\(\sigma_{b}(a')=a\) si i només si~\(a+b=a'\)
    i~\(a'+b=a\), que és equivalent a~\(a+2b=a\), que només pot ser cert
    si~\(2b=0\). Ara bé, hem suposat~\(b\neq0\), i~\(m\) és senar, pel
    que~\(2b\neq0\) i tenim que la descomposició en transposicions de la
    permutació~\(\sigma_{b}\) no té cap element repetit. Per tant, donat
    que~\(\sigma_{b}\) descompon en~\(m-1\) transposicions tenim que té
    signe~\((-1)^{m-1}\), que per ser~\(m\) senar és~\(1\).

    Tenim que
    \begin{multline*}
        \bigl((\sigma_{b}\mu_{n})\times i\bigr)(a,b)
        =
        \bigl(\sigma_{b}\mu_{n}(a),b\bigr)
        =
        \bigl(\sigma_{b}(an),b\bigr)
        =
        (an+b,b)
        = \\ =
        (an+b,b)
        =
        L^{-1}(an+b)
        =
        L^{-1}N(a,b).
    \end{multline*}
    i
    \begin{multline*}
        (i\times\sigma_{a}\mu_{m})(a,b)
        =
        \bigl(a,\sigma_{a}\mu_{m}(b))\bigr)
        =
        \bigl(a,\sigma_{a}(bm)\bigr)
        =
        (a,bm+a)
        = \\ =
        (a,bm+a)
        =
        L^{-1}(bm+a)
        =
        L^{-1}M(a,b),
    \end{multline*}
    on hem utilitzat~\(bm+a\equiv a\pmod{m}\).
\end{solution}

\begin{enumerate}
    \item[\textbf{f)}] Demostreu que el signe de la permutació
        de~\(\ZZ/m\ZZ\times\ZZ/n\ZZ\) donada per la bijecció~\(N^{-1}M\)
        és~\((-1)^{(m-1)(n-1)/4}\).
\end{enumerate}

\begin{solution}
    Observem que
    \[
        \sgn(L^{-1}M)
        =
        \sgn\bigl(i\times(\sigma_{a}\mu_{m})\bigr)
        =
        \sgn(\sigma_{a})\sgn(\mu_{m})
        =
        \sgn(\mu_{m})
        =
        \Bigl(\frac{m}{n}\Bigr)
    \]
    i utilitzant l'ordre lexicogràfic de~\(\ZZ/m\ZZ\times\ZZ/n\ZZ\) obtenim que
    \[
        \sgn(L^{-1}M)
        =
        (-1)^{(m-1)(n-1)/4}.
        \qedhere
    \]
\end{solution}

\begin{enumerate}
    \item[\textbf{g)}] Deduïu de~\((L^{-1}N)(N^{-1}M)=L^{-1}M\) la Llei de la
        reciprocitat quadràtica per al símbol de Jacobi:
        Si~\((m,n)=1\), aleshores
        \[
            \Bigl(\frac{m}{n}\Bigr)
            \Bigl(\frac{n}{m}\Bigr)
            =
            (-1)^{\frac{m-1}{2}\frac{n-1}{2}}.
        \]
\end{enumerate}

\begin{solution}
    % TODO
\end{solution}

\end{document}
